{"version":3,"sources":["app/search/searchAnime.js","app/anime/searchedAnime.component.js","app/anime/animeContainer.component.js","app/search/search.component.js","hooks/useLocalStorage.hook.js","hooks/useDebounce.hook.js","hooks/useDidMount.hook.js","app/App.js","reportWebVitals.js","index.js"],"names":["searchAnime","search","a","process","queryString","fetch","then","r","json","results","catch","error","console","data","slice","SearchedAnimeComponent","prop","malId","imageUrl","title","className","alt","src","React","memo","AnimeContainerComponent","anime","animeList","map","result","mal_id","image_url","SearchComponent","useState","searchInput","setSearchInput","setResults","isSearching","setIsSearching","searchHistory","setSearchHistory","pastResults","setPastResults","key","localStorage","getItem","currentValue","setCurrentValue","useEffect","handler","e","storageArea","newValue","window","addEventListener","removeEventListener","setItem","useLocalStorage","history","setHistory","debouncedValue","value","delay","setDebouncedValue","setTimeout","clearTimeout","useDebounce","didMount","mountRef","useRef","current","useDidMount","length","searchResults","aria-label","placeholder","onChange","event","target","element","index","Math","random","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.67b8742e.chunk.js","sourcesContent":["export default async function searchAnime(search) {\n  const apiAddress = process.env.REACT_APP_API_ADDRESS;\n  const queryString = `?q=${search}`;\n\n  const data =\n    (await fetch(`${apiAddress}${queryString}`)\n      .then((r) => r.json())\n      .then((r) => r.results)\n      .catch((error) => {\n        console.error(error);\n        return [];\n      })) || [];\n\n  return data.slice(0, 5);\n}\n","import React from 'react';\n\nconst SearchedAnimeComponent = (prop) => {\n  const { malId, imageUrl, title } = prop;\n  return (\n    <div key={malId} className=\"Anime-item\">\n      <img alt=\"Обложка тайтла\" src={imageUrl} className=\"Anime-img\" />\n      <p className=\"Anime-title\">{title}</p>\n    </div>\n  );\n};\n\nexport default React.memo(SearchedAnimeComponent);\n","import React from 'react';\nimport './anime.css';\nimport SearchedAnimeComponent from './searchedAnime.component';\n\nconst AnimeContainerComponent = (prop) => {\n  const { anime } = prop;\n  let animeList = [];\n\n  try {\n    animeList = anime.map((result) => (\n      <li key={`li_${result.mal_id || ''}`}>\n        <SearchedAnimeComponent\n          malId={result.mal_id || ''}\n          imageUrl={result.image_url || ''}\n          title={result.title || ''}\n        />\n      </li>\n    ));\n  } catch (error) {\n    console.error(error);\n    return null;\n  }\n\n  return <ul className=\"Anime\">{animeList}</ul>;\n};\n\nexport default React.memo(AnimeContainerComponent);\n","import React, { useEffect, useState } from 'react';\nimport './search.css';\nimport useDebounce from '../../hooks/useDebounce.hook';\nimport useLocalStorage from '../../hooks/useLocalStorage.hook';\nimport searchAnime from './searchAnime';\nimport AnimeContainerComponent from '../anime/animeContainer.component';\nimport useDidMount from '../../hooks/useDidMount.hook';\n\nconst SearchComponent = () => {\n  const [searchInput, setSearchInput] = useState('');\n  const [results, setResults] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchHistory, setSearchHistory] = useState([]);\n  const [pastResults, setPastResults] = useState([]);\n\n  const [history, setHistory] = useLocalStorage('history');\n\n  const debouncedValue = useDebounce(searchInput, 1000);\n\n  const didMount = useDidMount();\n\n  useEffect(() => {\n    if (debouncedValue && debouncedValue.length > 2) {\n      setIsSearching(true);\n\n      if (results.length > 0) {\n        setPastResults(results || []);\n      }\n\n      searchAnime(debouncedValue).then((searchResults) => {\n        setSearchHistory([debouncedValue, ...searchHistory]);\n        setHistory(debouncedValue);\n        setIsSearching(false);\n        setResults(searchResults);\n      });\n    }\n  }, [debouncedValue]);\n\n  useEffect(() => {\n    if (pastResults.length === 0 && didMount()) {\n      searchAnime(history).then((searchResults) => {\n        setPastResults(searchResults);\n      });\n    }\n\n    if (\n      history !== debouncedValue &&\n      history !== searchHistory[0] &&\n      results !== pastResults\n    ) {\n      setSearchInput(history);\n    }\n  }, [history]);\n\n  return (\n    <div>\n      <div className=\"Search-container\">\n        <input\n          aria-label=\"Поисковое поле\"\n          placeholder={`Введите запрос, например, ${history || 'pupa'}`}\n          className=\"Search\"\n          onChange={(event) => setSearchInput(event.target.value)}\n        />\n\n        <div className=\"Search-history\">\n          <h4>Последние запросы:</h4>\n          <ul>\n            {searchHistory.slice(0, 3).map((element, index) => (\n              <li key={`${Math.random() * index}_${element}`}>{element}</li>\n            ))}\n          </ul>\n        </div>\n      </div>\n\n      {isSearching && <div>Поиск...</div>}\n\n      {results && history !== searchHistory[1] ? (\n        <>\n          <AnimeContainerComponent anime={results} />\n        </>\n      ) : null}\n\n      {pastResults ? (\n        <>\n          <h3>Последний поиск</h3>\n          <AnimeContainerComponent anime={pastResults} />\n        </>\n      ) : null}\n    </div>\n  );\n};\n\nexport default SearchComponent;\n","import { useState, useEffect } from 'react';\n\nexport default function useLocalStorage(key) {\n  const [currentValue, setCurrentValue] = useState(() =>\n    localStorage.getItem(key)\n  );\n\n  useEffect(() => {\n    const handler = (e) => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setCurrentValue(e.newValue);\n      }\n    };\n    window.addEventListener('storage', handler);\n    return () => {\n      window.removeEventListener('storage', handler);\n    };\n  });\n\n  useEffect(() => {\n    localStorage.setItem(key, currentValue);\n  }, [key, currentValue]);\n\n  return [currentValue, setCurrentValue];\n}\n","import { useState, useEffect } from 'react';\n\nexport default function useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value]);\n\n  return debouncedValue;\n}\n","import { useEffect, useRef } from 'react';\n\nexport default function useDidMount() {\n  const mountRef = useRef(false);\n\n  useEffect(() => {\n    mountRef.current = true;\n  }, []);\n\n  return () => mountRef.current;\n}\n","import React from 'react';\nimport './App.css';\nimport SearchComponent from './search/search.component';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <div className=\"App-header__logo\">anifind</div>\n      </header>\n      <main className=\"App-main\">\n        <SearchComponent />\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}