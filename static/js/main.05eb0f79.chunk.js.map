{"version":3,"sources":["app/search/searchAnime.js","app/anime/searchedAnime.component.js","app/anime/animeContainer.component.js","app/search/search.component.js","hooks/useLocalStorage.hook.js","hooks/useDebounce.hook.js","hooks/useDidMount.hook.js","app/App.js","reportWebVitals.js","index.js"],"names":["search","a","process","queryString","fetch","then","r","json","results","catch","error","console","data","slice","SearchedAnimeComponent","prop","anime","action","history","className","onClick","event","onKeyDown","role","tabIndex","title","alt","src","image_url","mal_id","React","memo","AnimeContainerComponent","animeList","map","result","SearchComponent","useState","isSearching","setIsSearching","searchInput","setSearchInput","setResults","priorityResults","setPriorityResults","searchHistory","setSearchHistory","resultsHistory","setResultsHistory","key","localStorage","getItem","currentValue","setCurrentValue","useEffect","handler","e","storageArea","newValue","window","addEventListener","removeEventListener","setItem","log","useLocalStorage","setHistory","debouncedValue","value","delay","setDebouncedValue","setTimeout","clearTimeout","useDebounce","didMount","mountRef","useRef","current","useDidMount","JSON","parse","length","find","toLowerCase","includes","filter","searchAnime","searchResults","stringify","aria-label","placeholder","onChange","target","minLength","undefined","stopPropagation","filteredResult","App","href","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.05eb0f79.chunk.js","sourcesContent":["export default async function searchAnime(search) {\n  const apiAddress = process.env.REACT_APP_API_ADDRESS;\n  const queryString = `?q=${search}`;\n\n  const data =\n    (await fetch(`${apiAddress}${queryString}`)\n      .then((r) => r.json())\n      .then((r) => r.results)\n      .catch((error) => {\n        console.error(error);\n        return [];\n      })) || [];\n\n  return data.slice(0, 5);\n}\n","import React from 'react';\n\nconst SearchedAnimeComponent = (prop) => {\n  const { anime, action, history } = prop;\n\n  return (\n    <div\n      key={anime.mal_id || ''}\n      className={`Anime-item ${history}`}\n      onClick={(event) => action(event, anime) || null}\n      onKeyDown={(event) => action(event, anime) || null}\n      role=\"button\"\n      tabIndex={0}\n      title={\n        history ? 'Нажмите, чтобы удалить' : 'Нажмите, чтобы добавить в список'\n      }\n    >\n      <img\n        alt=\"Обложка тайтла\"\n        src={anime.image_url || ''}\n        className=\"Anime-img\"\n      />\n      <p className=\"Anime-title\">{anime.title || ''}</p>\n    </div>\n  );\n};\n\nexport default React.memo(SearchedAnimeComponent);\n","import React from 'react';\nimport './anime.css';\nimport SearchedAnimeComponent from './searchedAnime.component';\n\nconst AnimeContainerComponent = (prop) => {\n  const { anime, action, history } = prop;\n  let animeList = [];\n\n  try {\n    animeList = anime.map((result) => (\n      <li key={`li_${result.mal_id || ''}`}>\n        <SearchedAnimeComponent\n          anime={result}\n          action={action || null}\n          history={history}\n        />\n      </li>\n    ));\n  } catch (error) {\n    console.error(error);\n    return null;\n  }\n\n  return <ul className=\"Anime\">{animeList}</ul>;\n};\n\nexport default React.memo(AnimeContainerComponent);\n","import React, { useEffect, useState } from 'react';\nimport './search.css';\nimport useDebounce from '../../hooks/useDebounce.hook';\nimport useLocalStorage from '../../hooks/useLocalStorage.hook';\nimport searchAnime from './searchAnime';\nimport AnimeContainerComponent from '../anime/animeContainer.component';\nimport useDidMount from '../../hooks/useDidMount.hook';\n\nconst SearchComponent = () => {\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchInput, setSearchInput] = useState('');\n  const [results, setResults] = useState([]);\n  const [priorityResults, setPriorityResults] = useState([]);\n  const [searchHistory, setSearchHistory] = useState([]);\n  const [resultsHistory, setResultsHistory] = useState([]);\n\n  const [history, setHistory] = useLocalStorage('history');\n\n  const debouncedValue = useDebounce(searchInput, 900);\n\n  const didMount = useDidMount();\n\n  useEffect(() => {\n    if (didMount()) {\n      setResultsHistory(JSON.parse(history));\n    }\n\n    if (debouncedValue && debouncedValue.length > 2) {\n      setIsSearching(true);\n\n      if (\n        searchHistory.find((anime) =>\n          anime.toLowerCase().includes(debouncedValue.toLowerCase())\n        )\n      ) {\n        setPriorityResults(\n          resultsHistory.filter((anime) =>\n            anime.title.toLowerCase().includes(debouncedValue.toLowerCase())\n          )\n        );\n      } else {\n        setPriorityResults([]);\n      }\n\n      searchAnime(debouncedValue).then((searchResults) => {\n        setIsSearching(false);\n        setResults(searchResults);\n      });\n    }\n  }, [debouncedValue]);\n\n  useEffect(() => {\n    if (resultsHistory) {\n      setHistory(JSON.stringify(resultsHistory));\n      setSearchHistory(resultsHistory.map((result) => result.title));\n    }\n  }, [resultsHistory]);\n\n  const saveSearch = (event, anime) => {\n    if (event.key === 'Enter' || event.key === undefined) {\n      event.stopPropagation();\n\n      if (!resultsHistory.includes(anime)) {\n        setResultsHistory([anime, ...resultsHistory]);\n      }\n    }\n  };\n\n  const removeFromHistory = (event, anime) => {\n    if (event.key === 'Enter' || event.key === undefined) {\n      event.stopPropagation();\n\n      setResultsHistory(\n        resultsHistory.filter(\n          (filteredResult) => filteredResult.mal_id !== anime.mal_id\n        )\n      );\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"Search-container\">\n        <input\n          aria-label=\"Поисковое поле\"\n          placeholder={`Введите запрос, например, ${\n            searchHistory[0] || 'pupa'\n          } `}\n          className=\"Search\"\n          onChange={(event) => setSearchInput(event.target.value)}\n          minLength=\"3\"\n        />\n\n        {isSearching && <div>Поиск...</div>}\n\n        {!isSearching && results.length === 0 && searchInput && (\n          <div>По вашему запросу, похоже, ничего не найдено :(</div>\n        )}\n      </div>\n\n      {priorityResults.length !== 0 && searchInput && (\n        <div className=\"Search-history\">\n          <h5 className=\"Search-lastSearch\">Из истории запросов</h5>\n          <AnimeContainerComponent anime={priorityResults.slice(0, 5)} />\n        </div>\n      )}\n\n      {results && searchInput && (\n        <AnimeContainerComponent anime={results} action={saveSearch} />\n      )}\n\n      {resultsHistory && resultsHistory.length > 0 && (\n        <>\n          <h2 className=\"Search-lastSearch\">История запросов</h2>\n          <AnimeContainerComponent\n            anime={resultsHistory.slice(0, 5)}\n            action={removeFromHistory}\n            history=\"history\"\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default SearchComponent;\n","import { useState, useEffect } from 'react';\n\nexport default function useLocalStorage(key) {\n  const [currentValue, setCurrentValue] = useState(() =>\n    localStorage.getItem(key)\n  );\n\n  useEffect(() => {\n    const handler = (e) => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setCurrentValue(e.newValue);\n      }\n    };\n    window.addEventListener('storage', handler);\n    return () => {\n      window.removeEventListener('storage', handler);\n    };\n  });\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(key, currentValue);\n    } catch (error) {\n      console.log(error);\n    }\n  }, [key, currentValue]);\n\n  return [currentValue, setCurrentValue];\n}\n","import { useState, useEffect } from 'react';\n\nexport default function useDebounce(value, delay) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value]);\n\n  return debouncedValue;\n}\n","import { useEffect, useRef } from 'react';\n\nexport default function useDidMount() {\n  const mountRef = useRef(false);\n\n  useEffect(() => {\n    mountRef.current = true;\n  }, []);\n\n  return () => mountRef.current;\n}\n","import React from 'react';\nimport './App.css';\nimport SearchComponent from './search/search.component';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <a aria-label=\"Заголовок\" className=\"App-header__logo\" href=\"/anifind/\">\n          anifind\n        </a>\n      </header>\n      <main className=\"App-main\">\n        <SearchComponent />\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}